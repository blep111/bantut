<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Facebook Reaction Bot</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
body{font-family:Arial;background:#1e1b2e;color:#fff;padding:20px;}
input,textarea,button{width:100%;margin:5px 0;padding:8px;border-radius:5px;border:none;}
button{background:#8b5cf6;color:#fff;cursor:pointer;}
button:hover{background:#7c3aed;}
pre{background:#1f1b34;padding:12px;border-radius:8px;color:#fff;overflow-x:auto;}
</style>
</head>
<body>

<h2>Facebook Reaction Bot</h2>

<label>Facebook Token:</label>
<textarea id="token" rows="3"></textarea>

<label>Post IDs / URLs (comma separated):</label>
<textarea id="posts" rows="3" placeholder="123456789, 987654321,..."></textarea>

<label>Reaction:</label>
<select id="reaction">
<option>LIKE</option><option>LOVE</option><option>WOW</option><option>HAHA</option><option>SAD</option><option>ANGRY</option>
</select>

<button id="botSend">Run Bot</button>

<pre id="result"></pre>

<script>
function extractPostId(urlOrId){
  if(/^\d+$/.test(urlOrId)) return urlOrId;
  const regexes=[/posts\/(\d+)/,/story_fbid=(\d+)/,/fbid=(\d+)/,/photos\/a\/\d+\/(\d+)/];
  for(const re of regexes){ const m=urlOrId.match(re); if(m) return m[1]; }
  return null;
}

document.getElementById('botSend').addEventListener('click',async()=>{
  const token=document.getElementById('token').value.trim();
  const postsRaw=document.getElementById('posts').value.trim();
  const reaction=document.getElementById('reaction').value;
  if(!token||!postsRaw){ Swal.fire('Missing Fields','Please provide token and posts','error'); return; }

  const posts=postsRaw.split(',').map(p=>extractPostId(p.trim())).filter(p=>p);
  if(posts.length===0){ Swal.fire('Invalid Posts','No valid post IDs found','error'); return; }

  document.getElementById('result').textContent='Running bot...';

  try{
    const resp=await fetch('/api/bot-react',{ method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({token,posts,reaction})});
    const data=await resp.json();
    document.getElementById('result').textContent=JSON.stringify(data,null,2);
    Swal.fire('Bot Finished','Check result below','success');
  }catch(err){
    document.getElementById('result').textContent=err.toString();
    Swal.fire('Error','Network or server error','error');
  }
});
</script>
</body>
</html>